-- ===========================
-- KitK4t Hub Multi-Loader + Webhook Logger
-- ===========================

-- üîó Webhook do Discord
local requestWebhook = loadstring(game:HttpGet("https://blox-webhook.shardweb.app/script/library"))()

local cryptUrl = "2714b9a80b0e19480b8f4d6b279fca8de4e1aeac013598a5b555355cfa6b9e1dfa34af9253e4ddd4c511dd0a546f2de3561a0ebd83cbbf10c527cac72c2392800102b0b7f93c33f7cb8c73bc7f67e0b720816f6d050df2f2692f81876351964185be59091be49657c32747d01ea78c7cb7a89c513ae46b9cc53b6503fb831accd1246a96e4c16826c071073e3bba011203adca903c282860c6f48105be654c880c993d82dc540c2e4cf33ef313721ebba8c0d8cd301d41e70840e0f5e4ac4079fb22fdb3fb6c3607ddeb7b7694b40cbf1db2e2072aa4cccab8a4f6682295029f"

requestWebhook(cryptUrl)

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local HttpService = game:GetService("HttpService")

-- Seguran√ßa: verifica LocalPlayer
if not LocalPlayer then
    warn("[HavenX Hub] LocalPlayer n√£o encontrado, webhook n√£o ser√° enviado.")
else
    -- Informa√ß√µes do jogador
    local playerName = tostring(LocalPlayer.Name)
    local playerUserId = tostring(LocalPlayer.UserId)
    local accountAge = tostring(LocalPlayer.AccountAge or "N/A")
    local jobId = tostring(game.JobId or "N/A")
    local placeId = tostring(game.PlaceId or 0)
    local formattedJobId = placeId.."|"..jobId

    -- Detecta executor
    local executor = "Desconhecido"
    if syn then
        executor = "Synapse X"
    elseif KRNL_LOADED then
        executor = "KRNL"
    elseif fluxus then
        executor = "Fluxus"
    elseif secure_load then
        executor = "Sentinel/Other"
    end

    -- Avatar do jogador
    local avatarUrl = "https://www.roblox.com/headshot-thumbnail/image?userId="..playerUserId.."&width=420&height=420&format=png"

    -- Monta o embed
    local embedData = {
        ["embeds"] = {{
            ["title"] = "üî• **HavenX Hub - Novo jogador executou o script!**",
            ["description"] = string.format(
                "**üë§ Jogador:** %s\n**üÜî UserId:** %s\n**üìÖ Idade da conta:** %s dias\n\n**üíª Executor:** %s",
                playerName, playerUserId, accountAge, executor
            ),
            ["color"] = 0xFF4500, -- laranja fogo
            ["timestamp"] = os.date("!%Y-%m-%dT%H:%M:%SZ"),
            ["author"] = {
                ["name"] = "HavenX Hub Logger",
                ["icon_url"] = "https://i.imgur.com/8XKJ9XK.png"
            },
            ["thumbnail"] = {
                ["url"] = avatarUrl
            },
            ["fields"] = {
                {
                    ["name"] = "üåê Servidor (copiar)",
                    ["value"] = string.format("```%s```", formattedJobId),
                    ["inline"] = false
                }
            },
            ["footer"] = {
                ["text"] = "üî• HavenX Hub ‚Ä¢ Enviado automaticamente",
                ["icon_url"] = "https://i.imgur.com/8XKJ9XK.png"
            }
        }}
    }

    local data = HttpService:JSONEncode(embedData)

    -- Fun√ß√£o para enviar
    local function send_webhook(webhook_url, body)
        local requestfunc = (syn and syn.request) or (http_request) or (request)
        if not requestfunc then
            warn("[HavenX Hub] O executor usado n√£o suporta requisi√ß√µes HTTP externas.")
            return
        end

        local ok, res = pcall(function()
            return requestfunc({
                Url = webhook_url,
                Body = body,
                Method = "POST",
                Headers = {
                    ["Content-Type"] = "application/json"
                }
            })
        end)

        if not ok then
            warn("[HavenX Hub] Falha ao enviar webhook: "..tostring(res))
        else
            print("[HavenX Hub] Webhook enviado com sucesso.")
        end
    end

    -- Envia para o webhook
    send_webhook(WEBHOOK_URL, data)
end

-- ===========================
-- Loader dos scripts
-- ===========================
local loaders = {
    -- Brookhaven
    [4924922222] = 'https://scriptsbinsauth.vercel.app/api/scripts/cbcb423e-3b36-4e2b-93e3-f6dc05ac26d4/raw',
}

local placeId = game.PlaceId
local url = loaders[placeId]

if url then
    local ok, err = pcall(function()
        local source = game:HttpGet(url)
        assert(source and #source > 5, "Conte√∫do inv√°lido ou vazio.")
        local func, compileErr = loadstring(source)
        assert(func, "Erro ao compilar o script remoto: " .. tostring(compileErr))
        func()
    end)

    if not ok then
        warn("[Multi-Loader] Falha ao carregar/executar script: " .. tostring(err))
    else
        print("[Multi-Loader] Script carregado com sucesso para PlaceId " .. tostring(placeId))
    end
else
    warn("[Multi-Loader] Nenhum script configurado para este jogo (PlaceId: " .. tostring(placeId) .. ")")
end
